{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/forms\";\nfunction DataTableComponent_th_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const column_r3 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(column_r3.name);\n  }\n}\nfunction DataTableComponent_td_10_input_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"input\", 9);\n  }\n  if (rf & 2) {\n    const column_r4 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵpropertyInterpolate(\"type\", column_r4.type);\n  }\n}\nfunction DataTableComponent_td_10_label_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\");\n    i0.ɵɵtext(1, \"-\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction DataTableComponent_td_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtemplate(1, DataTableComponent_td_10_input_1_Template, 1, 1, \"input\", 7);\n    i0.ɵɵtemplate(2, DataTableComponent_td_10_label_2_Template, 2, 0, \"label\", 8);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const column_r4 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵclassMap(ctx_r1.columnIsObject(column_r4) ? \"text-center\" : \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.columnIsObject(column_r4));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.columnIsObject(column_r4));\n  }\n}\nfunction DataTableComponent_tr_14_td_1_input_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"input\", 13);\n    i0.ɵɵlistener(\"ngModelChange\", function DataTableComponent_tr_14_td_1_input_1_Template_input_ngModelChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const column_r12 = i0.ɵɵnextContext().$implicit;\n      const row_r8 = i0.ɵɵnextContext().$implicit;\n      return i0.ɵɵresetView(row_r8.editData[column_r12.name] = $event);\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const column_r12 = i0.ɵɵnextContext().$implicit;\n    const row_r8 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵpropertyInterpolate(\"type\", column_r12.type);\n    i0.ɵɵproperty(\"disabled\", !row_r8.editMode)(\"ngModel\", row_r8.editData[column_r12.name]);\n  }\n}\nfunction DataTableComponent_tr_14_td_1_button_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r23 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function DataTableComponent_tr_14_td_1_button_2_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r23);\n      const column_r12 = i0.ɵɵnextContext().$implicit;\n      const row_r8 = i0.ɵɵnextContext().$implicit;\n      const ctx_r21 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r21.showObject(column_r12, row_r8));\n    });\n    i0.ɵɵtext(1, \"Show object\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction DataTableComponent_tr_14_td_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtemplate(1, DataTableComponent_tr_14_td_1_input_1_Template, 1, 3, \"input\", 11);\n    i0.ɵɵtemplate(2, DataTableComponent_tr_14_td_1_button_2_Template, 2, 0, \"button\", 12);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const column_r12 = ctx.$implicit;\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassMap(ctx_r9.columnIsObject(column_r12) ? \"text-center\" : \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r9.columnIsObject(column_r12));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r9.columnIsObject(column_r12));\n  }\n}\nfunction DataTableComponent_tr_14_td_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r27 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\", 4)(1, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function DataTableComponent_tr_14_td_2_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r27);\n      const row_r8 = i0.ɵɵnextContext().$implicit;\n      const ctx_r25 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r25.edit(row_r8));\n    });\n    i0.ɵɵtext(2, \"Edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function DataTableComponent_tr_14_td_2_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r27);\n      const row_r8 = i0.ɵɵnextContext().$implicit;\n      const ctx_r28 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r28.delete(row_r8));\n    });\n    i0.ɵɵtext(4, \"Delete\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction DataTableComponent_tr_14_td_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r32 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\", 4)(1, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function DataTableComponent_tr_14_td_3_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r32);\n      const row_r8 = i0.ɵɵnextContext().$implicit;\n      const ctx_r30 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r30.save(row_r8));\n    });\n    i0.ɵɵtext(2, \"Save\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function DataTableComponent_tr_14_td_3_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r32);\n      const row_r8 = i0.ɵɵnextContext().$implicit;\n      const ctx_r33 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r33.cancel(row_r8));\n    });\n    i0.ɵɵtext(4, \"Cancel\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction DataTableComponent_tr_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵtemplate(1, DataTableComponent_tr_14_td_1_Template, 3, 5, \"td\", 5);\n    i0.ɵɵtemplate(2, DataTableComponent_tr_14_td_2_Template, 5, 0, \"td\", 10);\n    i0.ɵɵtemplate(3, DataTableComponent_tr_14_td_3_Template, 5, 0, \"td\", 10);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const row_r8 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.columns);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !row_r8.editMode);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", row_r8.editMode);\n  }\n}\nexport class DataTableComponent {\n  constructor() {\n    this.tablePattern = undefined;\n    this._prevTablePattern = undefined;\n    this._columns = [];\n    this._rows = [];\n    this.newEntity = {};\n  }\n  get columns() {\n    if (this.tablePattern === undefined) return [];\n    if (this._columns.length === 0 || this._prevTablePattern !== this.tablePattern) {\n      console.log('Load data for table pattern: ', this.tablePattern.api.url);\n      this._prevTablePattern = this.tablePattern;\n      this._columns = this.tablePattern.columns;\n      this.tablePattern.api.getAll().subscribe(data => {\n        console.log(data);\n        this._rows = data.map(row => {\n          return {\n            data: row,\n            editMode: false,\n            editData: {\n              ...row\n            }\n          };\n        });\n      });\n    }\n    return this._columns;\n  }\n  get rows() {\n    return this._rows;\n  }\n  columnIsObject(column) {\n    return typeof column.type !== \"string\";\n  }\n  showObject(column, row) {\n    alert(JSON.stringify(row.data[column.name], null, 2));\n  }\n  add() {}\n  edit(row) {\n    row.editMode = true;\n  }\n  save(row) {\n    row.editMode = false;\n    this.tablePattern?.api.update(row.data.id, row.editData).subscribe(data => {\n      row.data = data;\n    });\n  }\n  cancel(row) {\n    row.editMode = false;\n    row.editData = {\n      ...row.data\n    };\n  }\n  delete(row) {\n    this.tablePattern?.api.delete(row.data.id).subscribe(() => {\n      this._rows = this._rows.filter(_row => _row !== row);\n    });\n  }\n}\nDataTableComponent.ɵfac = function DataTableComponent_Factory(t) {\n  return new (t || DataTableComponent)();\n};\nDataTableComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: DataTableComponent,\n  selectors: [[\"app-data-table\"]],\n  inputs: {\n    tablePattern: \"tablePattern\"\n  },\n  decls: 15,\n  vars: 3,\n  consts: [[1, \"card-body\"], [1, \"table-responsive\"], [1, \"table\", \"table-striped\", \"table-bordered\"], [4, \"ngFor\", \"ngForOf\"], [1, \"actions\"], [3, \"class\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"button\", 1, \"btn\", \"btn-success\"], [\"type\", \"text\", 3, \"type\", 4, \"ngIf\"], [4, \"ngIf\"], [\"type\", \"text\", 3, \"type\"], [\"class\", \"actions\", 4, \"ngIf\"], [\"type\", \"text\", 3, \"disabled\", \"ngModel\", \"type\", \"ngModelChange\", 4, \"ngIf\"], [\"class\", \"btn btn-primary\", \"type\", \"button\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"text\", 3, \"disabled\", \"ngModel\", \"type\", \"ngModelChange\"], [\"type\", \"button\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [\"type\", \"button\", 1, \"btn\", \"btn-warning\", 3, \"click\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", 3, \"click\"], [\"type\", \"button\", 1, \"btn\", \"btn-success\", 3, \"click\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 3, \"click\"]],\n  template: function DataTableComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"table\", 2)(3, \"thead\")(4, \"tr\");\n      i0.ɵɵtemplate(5, DataTableComponent_th_5_Template, 2, 1, \"th\", 3);\n      i0.ɵɵelementStart(6, \"th\", 4);\n      i0.ɵɵtext(7, \"Actions\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(8, \"tbody\")(9, \"tr\");\n      i0.ɵɵtemplate(10, DataTableComponent_td_10_Template, 3, 5, \"td\", 5);\n      i0.ɵɵelementStart(11, \"td\", 4)(12, \"button\", 6);\n      i0.ɵɵtext(13, \"Add new\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵtemplate(14, DataTableComponent_tr_14_Template, 4, 3, \"tr\", 3);\n      i0.ɵɵelementEnd()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngForOf\", ctx.columns);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngForOf\", ctx.columns);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.rows);\n    }\n  },\n  dependencies: [i1.NgForOf, i1.NgIf, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgModel],\n  styles: [\"input[_ngcontent-%COMP%]{\\r\\n    width: 100%;\\r\\n}\\r\\n.text-center[_ngcontent-%COMP%], .actions[_ngcontent-%COMP%]{\\r\\n    text-align: center;\\r\\n}\\r\\nth.actions[_ngcontent-%COMP%]{\\r\\n    width: 200px;\\r\\n}\\r\\nbutton[_ngcontent-%COMP%]{\\r\\n    margin-left: 4px;\\r\\n    margin-right: 4px;\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9kYXRhLXRhYmxlL2RhdGEtdGFibGUuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLFdBQVc7QUFDZjtBQUNBOztJQUVJLGtCQUFrQjtBQUN0QjtBQUNBO0lBQ0ksWUFBWTtBQUNoQjtBQUNBO0lBQ0ksZ0JBQWdCO0lBQ2hCLGlCQUFpQjtBQUNyQiIsInNvdXJjZXNDb250ZW50IjpbImlucHV0e1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbn1cclxuLnRleHQtY2VudGVyLFxyXG4uYWN0aW9uc3tcclxuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxufVxyXG50aC5hY3Rpb25ze1xyXG4gICAgd2lkdGg6IDIwMHB4O1xyXG59XHJcbmJ1dHRvbntcclxuICAgIG1hcmdpbi1sZWZ0OiA0cHg7XHJcbiAgICBtYXJnaW4tcmlnaHQ6IDRweDtcclxufSJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","DataTableComponent","constructor","undefined","columns","tablePattern","_columns","length","_prevTablePattern","console","log","api","url","getAll","subscribe","data","_rows","map","row","editMode","editData","rows","columnIsObject","column","type","showObject","alert","JSON","stringify","name","add","edit","save","update","id","cancel","delete","filter","_row","selectors","inputs","decls","vars","consts","template"],"sourceRoot":"","sources":["P:\\NURE\\СРБД\\ssdb_lw_4\\ClientApp\\src\\app\\components\\data-table\\data-table.component.html","P:\\NURE\\СРБД\\ssdb_lw_4\\ClientApp\\src\\app\\components\\data-table\\data-table.component.ts"],"sourcesContent":["<div class=\"card-body\">\n    <div class=\"table-responsive\">\n        <table class=\"table table-striped table-bordered\">\n            <thead>\n                <tr>\n                    <th *ngFor=\"let column of columns\">{{column.name}}</th>\n                    <th class=\"actions\">Actions</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td *ngFor=\"let column of columns\" class=\"{{ columnIsObject(column) ? 'text-center' : ''}}\">\n                        <input *ngIf=\"!columnIsObject(column)\" type=\"text\" data-type=\"{{column.type}}\">\n                        <label *ngIf=\"columnIsObject(column)\">-</label>\n                    </td>\n                    <td class=\"actions\">\n                        <button class=\"btn btn-success\" type=\"button\">Add new</button>\n                    </td>\n                </tr>\n                <tr *ngFor=\"let row of rows\">\n                    <td *ngFor=\"let column of columns\" class=\"{{ columnIsObject(column) ? 'text-center' : ''}}\">\n                        <input *ngIf=\"!columnIsObject(column)\" [disabled]=\"!row.editMode\" [(ngModel)]=\"row.editData[column.name]\" type=\"text\" data-type=\"{{column.type}}\">\n                        <button *ngIf=\"columnIsObject(column)\" class=\"btn btn-primary\" type=\"button\" (click)=\"showObject(column, row)\">Show object</button>\n                    </td>\n                    <td class=\"actions\" *ngIf=\"!row.editMode\" >\n                        <button class=\"btn btn-warning\" type=\"button\" (click)=\"edit(row)\">Edit</button>\n                        <button class=\"btn btn-danger\" type=\"button\" (click)=\"delete(row)\">Delete</button>\n                    </td>\n                    <td class=\"actions\" *ngIf=\"row.editMode\" >\n                        <button class=\"btn btn-success\" type=\"button\" (click)=\"save(row)\">Save</button>\n                        <button class=\"btn btn-secondary\" type=\"button\" (click)=\"cancel(row)\">Cancel</button>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n</div>","import { Component, Input } from '@angular/core';\nimport { ColumnType, TablePattern } from 'src/app/models/TablePattern';\n\ntype RowType = {\n  data: any,\n  editMode: boolean,\n  editData: any\n}\n\n@Component({\n  selector: 'app-data-table',\n  templateUrl: './data-table.component.html',\n  styleUrls: ['./data-table.component.css']\n})\nexport class DataTableComponent {\n  @Input() \n  public tablePattern: TablePattern | undefined = undefined;\n\n  private _prevTablePattern: TablePattern | undefined = undefined;\n\n  private _columns: ColumnType[] = [];\n\n  private _rows: RowType[] = [];\n\n  public newEntity: any = {};\n\n  constructor() { }\n\n  public get columns(): ColumnType[] {\n    if(this.tablePattern === undefined)\n      return [];\n\n    if (this._columns.length === 0 || this._prevTablePattern !== this.tablePattern) {\n      console.log('Load data for table pattern: ', this.tablePattern.api.url);\n      this._prevTablePattern = this.tablePattern;\n      this._columns = this.tablePattern.columns;\n      this.tablePattern.api.getAll().subscribe((data: any[]) => {\n        console.log(data);\n        this._rows = data.map((row: any): RowType => {\n          return {\n            data: row,\n            editMode: false,\n            editData: {\n              ...row\n            }\n          }\n        });\n      });\n    }\n    return this._columns;\n  }\n  public get rows(): RowType[] {\n    return this._rows;\n  }\n\n  public columnIsObject(column: ColumnType): boolean {\n    return typeof column.type !== \"string\"\n  }\n\n  public showObject(column: ColumnType, row: RowType): void {\n    alert(JSON.stringify(row.data[column.name], null, 2));\n  }\n\n  public add(): void {\n  }\n\n  public edit(row: RowType): void {\n    row.editMode = true;\n  }\n\n  public save(row: RowType): void {\n    row.editMode = false;\n    this.tablePattern?.api.update(row.data.id, row.editData).subscribe((data: any) => {\n      row.data = data;\n    });\n  }\n\n  public cancel(row: RowType): void {\n    row.editMode = false;\n    row.editData = {\n      ...row.data\n    };\n  }\n\n  public delete(row: RowType): void {\n    this.tablePattern?.api.delete(row.data.id).subscribe(() => {\n      this._rows = this._rows.filter(_row => _row !== row);\n    });\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}